---
import { FAQ } from "@/components/faq/faq";
import Info from "@/components/info/info.astro";
import Layout from "@/components/layout/layout.astro";
import LeapOCR from "@/components/leapocr/LeapOCR.astro";
import Formatter from "@/components/playground/Formatter";
import { LANGUAGES } from "@/lib/languages";
import type { GetStaticPaths } from "astro";

export const getStaticPaths: GetStaticPaths = (async () => {
  const paths: any[] = [];

  // Generate paths for all languages
  Object.keys(LANGUAGES).forEach(langId => {
    paths.push({
      params: { lang: langId },
      props: {
        language: langId,
        languageConfig: LANGUAGES[langId],
        lang: langId,
      },
    });
  });

  return paths;
}) satisfies GetStaticPaths;

interface Props {
  language: string;
  languageConfig: any;
  lang: string;
}

const { language, languageConfig, lang: _lang } = Astro.props;

// Safety checks
if (!language || !languageConfig) {
  throw new Error(
    `Language or languageConfig is undefined. Language: ${language}`,
  );
}
---

<Layout
  title={`${languageConfig.name} Formatter - Format ${languageConfig.name} Code Online`}
  description={`Format ${languageConfig.name} code online with proper formatting. Clean, readable code in seconds.`}
  language={language}
  minify={false}
>
  <div class="container mx-auto px-4 py-6">
    <div class="bg-primary/10 border-2 border-primary p-6 mb-6">
      <div class="flex items-center gap-4 mb-4">
        <div class="flex items-center gap-3">
          <h1 class="text-2xl md:text-4xl font-display font-black text-foreground tracking-tight">
            {languageConfig.name} FORMATTER
          </h1>
          <div class="flex items-center gap-2">
            <span class="w-3 h-3 bg-primary animate-pulse"></span>
            <span class="px-3 py-1 bg-primary text-background text-sm font-mono font-bold uppercase border-2 border-primary">
              Format
            </span>
          </div>
        </div>
      </div>
      <div class="border-l-4 border-primary pl-4 mb-4">
        <p class="text-foreground font-medium leading-relaxed">
          Format your {languageConfig.name} code with proper indentation and
          syntax highlighting. Make your code clean and readable.
        </p>
      </div>
      <div class="flex items-center gap-4">
        <a
          href={`/${language}`}
          class="inline-flex items-center gap-2 px-4 py-2 bg-background border-2 border-foreground text-foreground font-mono text-sm font-bold hover:bg-primary hover:text-background transition-colors"
        >
          <span class="text-lg">‚Üê</span>
          Back to {languageConfig.name} Tool
        </a>
        <div class="hidden md:flex items-center gap-2 text-muted-foreground">
          <span class="w-2 h-2 bg-foreground/50"></span>
          <span class="font-mono text-xs uppercase">Clean & Readable</span>
        </div>
      </div>
    </div>
  </div>

  <Formatter
    client:load
    minifier={false}
    language={language}
  />
  <LeapOCR />
  <Info language={language} />
  <FAQ language={language} client:idle />
</Layout>
